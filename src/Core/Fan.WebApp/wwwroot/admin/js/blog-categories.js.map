{"version":3,"sources":["../../../Manage/Admin/client/js/blog-categories.js"],"names":["Vue","component","mixins","categoriesMixin","data","dialogVisible","title","description","upsertText","catEditing","errMsg","computed","disableUpsertButton","trim","length","addButtonVisible","payload","methods","closeDialog","addCat","editCat","cat","deleteCat","confirm","axios","delete","id","$root","headers","then","idx","categories","findIndex","c","defaultCat","find","defaultCategoryId","count","splice","toast","catch","toastError","setDefault","post","viewPosts","url","window","location","href","insertCat","resp","push","sortCategories","err","response","updateCat","sort","a","b","titleA","toUpperCase","titleB"],"mappings":"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","sourcesContent":["ï»¿/**\r\n * \r\n */\r\nVue.component('blog-categories', {\r\n    mixins: [categoriesMixin],\r\n    data: () => ({\r\n        dialogVisible: false,\r\n        title: '',\r\n        description: '',\r\n        upsertText: 'Add',\r\n        catEditing: null,\r\n        errMsg: '',\r\n    }),\r\n    computed: {\r\n        disableUpsertButton() {\r\n            return this.title.trim().length <= 0;\r\n        },\r\n        addButtonVisible() {\r\n            return this.upsertText === 'Add';\r\n        },\r\n        payload() {\r\n            return {\r\n                title: this.title,\r\n                description: this.description,\r\n            }\r\n        },\r\n    },\r\n    methods: {\r\n        closeDialog() {\r\n            this.dialogVisible = false;\r\n            this.title = '';\r\n            this.description = '';\r\n            this.errMsg = '';\r\n        },\r\n        // when user clicks on the plus fab to add a new category\r\n        addCat() {\r\n            this.dialogVisible = true;\r\n            this.title = '';\r\n            this.description = '';\r\n            this.upsertText = 'Add';\r\n        },\r\n        // when user clicks on the Edit from the dropdown\r\n        editCat(cat) {\r\n            this.dialogVisible = true;\r\n            this.catEditing = cat;\r\n            this.upsertText = 'Edit';\r\n            this.title = cat.title;\r\n            this.description = cat.description;\r\n        },\r\n        // when user clicks on the Delete from the dropdown\r\n        deleteCat(cat) {\r\n            console.log('cat being deleted: ', cat);\r\n            if (confirm(`Are you sure you want to permanently delete '${cat.title}'?`)) {\r\n                axios.delete(`/admin/categories?id=${cat.id}`, this.$root.headers)\r\n                    .then(resp => {\r\n                        let idx = this.categories.findIndex(c => c.id === cat.id);\r\n                        let defaultCat = this.categories.find(c => c.id === this.defaultCategoryId);\r\n                        defaultCat.count += cat.count;\r\n                        this.categories.splice(idx, 1);\r\n                        this.$root.toast('Category deleted.');\r\n                    })\r\n                    .catch(err => {\r\n                        this.$root.toastError('Delete category failed.');\r\n                        console.error(err);\r\n                    });\r\n            }\r\n        },\r\n        // when user clicks on the Set as Default from the dropdown\r\n        setDefault(id) {\r\n            axios.post(`/admin/categories?handler=default&id=${id}`, null, this.$root.headers)\r\n                .then(resp => {\r\n                    this.defaultCategoryId = id;\r\n                })\r\n                .catch(err => {\r\n                    this.$root.toastError('Set default category failed.');\r\n                    console.log(err);\r\n                });\r\n        },\r\n        // when user clicks on the View Posts from the dropdown\r\n        viewPosts(url) {\r\n            window.location.href = url; // relative \r\n        },\r\n        // when user clicks on the Add button on the dialog\r\n        insertCat() {\r\n            axios.post('/admin/categories', this.payload, this.$root.headers)\r\n                .then(resp => {\r\n                    this.closeDialog();\r\n                    this.categories.push(resp.data);\r\n                    this.sortCategories();\r\n                    this.$root.toast('New category added.');\r\n                })\r\n                .catch(err => {\r\n                    this.errMsg = err.response.data;\r\n                    this.$root.toastError('Add category failed.');\r\n                });\r\n        },\r\n        // when user clicks on the Update button on the dialog\r\n        updateCat() {\r\n            this.payload.id = this.catEditing.id;\r\n            this.payload.count = this.catEditing.count;\r\n            axios.post('/admin/categories?handler=update', this.payload, this.$root.headers)\r\n                .then(resp => {\r\n                    this.closeDialog();\r\n                    // replace\r\n                    let idx = this.categories.findIndex(c => c.id === resp.data.id);\r\n                    this.categories[idx] = resp.data;\r\n                    // sort\r\n                    this.sortCategories();\r\n                    this.$root.toast('Category updated.');\r\n                })\r\n                .catch(err => {\r\n                    this.errMsg = err.response.data;\r\n                    this.$root.toastError('Update category failed.');\r\n                });\r\n        },\r\n        sortCategories() {\r\n            this.categories.sort((a, b) => {\r\n                var titleA = a.title.toUpperCase();\r\n                var titleB = b.title.toUpperCase();\r\n                if (titleA < titleB) {\r\n                    return -1;\r\n                }\r\n                if (titleA > titleB) {\r\n                    return 1;\r\n                }\r\n\r\n                return 0; // equal\r\n            });\r\n        }\r\n    }\r\n});"],"file":"blog-categories.js"}