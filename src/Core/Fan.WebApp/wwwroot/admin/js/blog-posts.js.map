{"version":3,"sources":["../../../Manage/Admin/client/js/blog-posts.js"],"names":["Vue","component","mixins","blogPostsMixin","data","pagination","loading","watch","handler","activeStatus","getPosts","deep","computed","active","get","set","methods","status","url","page","rowsPerPage","axios","then","resp","posts","totalPosts","statuses","publishedCount","draftCount","window","location","href","endsWith","history","pushState","newUrl","catch","deletePost","item","index","indexOf","confirm","id","delete","headers","$root","tok","splice"],"mappings":"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","sourcesContent":["ï»¿Vue.component('blog-posts', {\r\n    mixins: [blogPostsMixin],\r\n    data: () => ({\r\n        pagination: {},\r\n        loading: false,\r\n    }),\r\n    watch: {\r\n        pagination: {\r\n            handler() {\r\n                console.log('this.activeStatus: ', this.activeStatus);\r\n                // vuetify tab caveat\r\n                if (this.activeStatus === 0)\r\n                    this.activeStatus = 'published';\r\n                else if (this.activeStatus === 1)\r\n                    this.activeStatus = 'draft';\r\n\r\n                this.getPosts(this.activeStatus);\r\n            },\r\n            deep: true,\r\n        },\r\n    },\r\n    computed: {\r\n        // vuetify tab is by physical order, thus this conversion\r\n        active: {\r\n            get: function () {\r\n                return (this.activeStatus === 'published') ? 0 : 1;\r\n            },\r\n            set: function (value) { },\r\n        },\r\n    },\r\n    methods: {\r\n        getPosts(status) {\r\n            this.activeStatus = status;\r\n            this.loading = true;\r\n            let url = `/admin/posts?handler=posts&status=${this.activeStatus}&pageNumber=${this.pagination.page}&pageSize=${this.pagination.rowsPerPage}`;\r\n            console.log(url);\r\n            axios.get(url).then(resp => {\r\n                this.posts = resp.data.posts;\r\n                this.totalPosts = resp.data.totalPosts;\r\n                this.statuses = resp.data.statuses;\r\n                this.publishedCount = resp.data.publishedCount;\r\n                this.draftCount = resp.data.draftCount;\r\n\r\n                if (window.location.href.endsWith('/admin/posts'))\r\n                    history.pushState({}, null, window.location.href + `/${this.activeStatus}`);\r\n                else if (window.location.href.endsWith('/admin/posts/published') ||\r\n                    window.location.href.endsWith('/admin/posts/draft')) {\r\n                    let newUrl = '/admin/posts/' + this.activeStatus;\r\n                    history.pushState({}, null, newUrl);\r\n                }\r\n            }).catch(function (error) {\r\n                console.log(error);\r\n            });\r\n            this.loading = false;\r\n        },\r\n        deletePost(item) {\r\n            const index = this.posts.indexOf(item);\r\n            if (confirm('You are permanently deleting this post, are you sure?')) {\r\n                this.loading = true;\r\n                let url = `/admin/posts?postId=${item.id}&status=${this.activeStatus}&pageNumber=${this.pagination.page}&pageSize=${this.pagination.rowsPerPage}`;\r\n                axios.delete(url, { headers: { 'XSRF-TOKEN': this.$root.tok } })\r\n                    .then(resp => {\r\n                        this.posts.splice(index, 1);\r\n                        this.posts = resp.data.posts;\r\n                        this.totalPosts = resp.data.totalPosts;\r\n                        this.statuses = resp.data.statuses;\r\n                        this.draftCount = resp.data.draftCount;\r\n                        this.publishedCount = resp.data.publishedCount;\r\n                    })\r\n                    .catch(function (err) {\r\n                        console.log(err);\r\n                    });\r\n                this.loading = false;\r\n            }\r\n        },\r\n    },\r\n});\r\n"],"file":"blog-posts.js"}